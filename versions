#!/bin/zsh
###########################################
# Module Versions Checker: Compares locally installed versions with the remote (recent) version info
# by Soomin K.
###########################################
# ~/z/dev/logo
C_R='\e[0;31m'
C_G='\e[0;32m'
C_B='\e[0;34m'
C_Y='\e[0;33m'
C_N='\e[0m'
# Following two variables will contain the version info and will be compared in showV()
# -------------------------------------------------
# VC: Version Current (local installed)
# VL: Version Latest (Remote)
# =================================================
# Set Module Info
# -------------------------------------------------
# argument $1: module name
# argument $2: L - local, R - remote, v - prefix to compare
# argument $3: remote module name (when it's different from the local)
setLR ()
{
  if [[ $1 == *"L"* ]]; then  # Local version info
    VC=`$2 --version`
  else
    VC=""
  fi
  if [[ $1 == *"R"* ]]; then  # Remote version info
    if [ -z $3 ]; then
      VL=`npm show $2 version`
    else
      VL=`npm show $3 version`
    fi
  else
    VL=""
  fi
}
# =================================================
# Show Versions
# -------------------------------------------------
# argument $1: title with emoji
# argument $2: additional info
showV ()
{
  printf "${C_Y}$1${C_G}: "

  if [ -z "${VC}" ]; then    # No installed version check, show shiny emoji before version info
    printf "${C_G}✨${VL}"
  else
    printf "${C_N}${VC}"
    if [ -z "${VL}" ]; then  # No remote version check
      printf "⚡️"
    else
      if [[ "${VC}" == *"${VL}"* ]]; then  # latest ver contained in installed?
        printf "✨"
      else
        printf "⚠️  ${C_G}${VL}${C_R}🌈"  # older or newer version installed
      fi
    fi
  fi

  if [ -z $2 ]; then   # No additional info provided
    print "${C_N}"
  else
    print " ${C_B}$2${C_N}"
  fi
}
# =================================================
# Header - show color scheme
print "${C_G}┌──────────┬───────────┬──────────┐"
print "${C_G}│ ${C_Y}Versions${C_G} │ ${C_N}Installed${C_G} │ Latest✨ │"
print "${C_G}└──────────┴───────────┴──────────┘"
# =================================================
# Main -- Since it takes time to run each step, show immediately each result
setLR LR node node@lts
showV "🍏 node    " "${C_R}`npm show node@latest version`🌈 ${C_B}# nvm ls"
# -------------------------------------------------
setLR LR ts-node
showV "🍋 ts-node " "TypeScript execution and REPL for node.js"
# -------------------------------------------------
setLR LR npm
showV "🎁 npm     " "[`npm bin -g`]"
# -------------------------------------------------
setLR LR yarn
showV "🧵 yarn    " "[`yarn global bin`]"
# -------------------------------------------------
#setLR LR webpack
#showV "📦 webpack " "@next:${C_R}`npm show webpack@next version`"
# -------------------------------------------------
setLR LR electron
showV "💡 electron"
# -------------------------------------------------
setLR LR create-react-app
showV "🥐 CRA     " "# create-react-app"
# -------------------------------------------------
setLR R react
showV "🍙 react   "
# -------------------------------------------------
setLR R react-scripts
showV "🍣 scripts " "# react-scripts"
# -------------------------------------------------
setLR R react-redux
showV "🐤 redux   " "# react-redux"
# -------------------------------------------------
setLR R react-native
showV "📱 r-native" "# react-native"
# -------------------------------------------------
setLR R flow-bin
showV "🍫 flow    " "# yarn add --dev flow-bin"
# -------------------------------------------------
setLR R webpack
showV "🛍  webpack "
# -------------------------------------------------
setLR R rxjs
showV "🍡 RxJS    "
# -------------------------------------------------
setLR R babylonjs
showV "🧬 Babylon " "# babylonjs"
# -------------------------------------------------
setLR LR babel babel-cli
showV "🌮 babel   " "# babel-cli"
# -------------------------------------------------
setLR LR eslint
showV "🍬 eslint  "
# -------------------------------------------------
setLR LR tsc typescript
showV "🍭 tsc     " "# typescript"
# -------------------------------------------------
setLR L dart
showV "🎯 dart    " "# brew info dart"
# -------------------------------------------------
setLR LR sass
showV "🍒 sass    " "# yarn global add sass"
# -------------------------------------------------
setLR LR gatsby gatsby-cli
showV "💋 gatsby  " "# yarn global add gatsby-cli"
# -------------------------------------------------
setLR L ruby
showV "🔮 ruby    "
# -------------------------------------------------
setLR L python
showV "🐍 python  "
# -------------------------------------------------
setLR L pip3
showV "🐢 pip     "
print "🦎 ${C_B}pip-check for further information${C_N}"
# -------------------------------------------------
setLR L rustup
showV "💎 rustup  " "# rustup show"
# -------------------------------------------------
setLR L rustc
showV "⚙️a rustc   "
# -------------------------------------------------
setLR L cargo
showV "📦 cargo   "
# -------------------------------------------------
setLR L flutter
showV "🐝 flutter " "# flutter upgrade"
# -------------------------------------------------
VC=`xcodebuild -version`
showV "🛠  xcode   " "# xcodebuild"
# -------------------------------------------------
setLR L swift
showV "🐦 swift   "
# -------------------------------------------------
VC=`kotlin -version`
showV "🦋 kotlin  " "# brew install kotlin"
# -------------------------------------------------
setLR LR firebase firebase-tools
showV "🔥 firebase" "# yarn global add firebase-tools"
# -------------------------------------------------
VC=''
showV "☕️ java    "
java -version
# -------------------------------------------------
python -m site --user-site
python -m pip list | rg tensorflow
# End
