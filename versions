#!/bin/zsh
###########################################
# Module Versions Checker
# by Soomin K.
###########################################
C_R='\e[0;31m'
C_G='\e[0;32m'
C_B='\e[0;34m'
C_Y='\e[0;33m'
C_N='\e[0m'
# Set Module
# $1: module name
# $2: L - local, R - remote
# $3: remote modifier such as @lts
setM ()
{
  if [[ $1 == *"L"* ]]; then
    VC=`$2 --version`
  else
    VC=""
  fi
  if [[ $1 == *"R"* ]]; then
    if [ -z $3 ]; then
      VL=`npm show $2 version`
    else
      VL=`npm show $2$3 version`
    fi
  else
    VL=""
  fi
}

# Show Versions
# $1: title with emoji
# $2: additional info
showV ()
{
  printf "${C_Y}$1${C_G}: "

  if [ -z "${VC}" ]; then
    printf "${C_G}âœ¨${VL}"
  else
    printf "${C_N}${VC}"
    if [ -z "${VL}" ]; then
      printf "âš¡ï¸"
    else
      if [ "${VC}" = "${VL}" ]; then
        printf "âœ¨"
      else
        printf "âœ”ï¸  ${C_G}${VL}${C_R}ğŸŒˆNewâ—ï¸"
      fi
    fi
  fi

  if [ -z $2 ]; then
    print "${C_N}"
  else
    print " ${C_B}$2${C_N}"
  fi
}

# Header - show color scheme
print "${C_G}â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
print "${C_G}â”‚ ${C_Y}Versions${C_G} â”‚ ${C_N}Installed${C_G} â”‚ Latestâœ¨ â”‚"
print "${C_G}â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"

# Main -- Since it takes time to run each step, show immediately each result
setM LR node @lts
VL="v${VL}"
showV "ğŸ node    " "${C_R}`npm show node@latest version`ğŸŒˆ ${C_B}# nvm -ls"

setM LR npm
showV "ğŸ npm     " "[`npm bin -g`]"

setM LR yarn
showV "ğŸ§µ  yarn    " "[`yarn global bin`]"

setM LR webpack
showV "ğŸ“¦ webpack " "@next:${C_R}`npm show webpack@next version`"

setM LR create-react-app
showV "ğŸ¥ CRA     " "# create-react-app"

setM R react
showV "ğŸ™ react   "

setM R react-scripts
showV "ğŸ£ scripts " "# react-scripts"

setM R typescript
showV "ğŸ­ ts      " "# typescript"

setM L ruby
showV "ğŸ”® ruby    "

setM L python
showV "ğŸ python  "

setM L pip3
showV "ğŸ¢ pip     "
print "ğŸ¦ ${C_B}pip-check for further information${C_N}"

setM L rustup
showV "ğŸ’ rustup  " "# rustup show"

setM L rustc
showV "âš™ï¸a rustc   "

setM L cargo
showV "ğŸ“¦ cargo   "
# End
